#!/usr/bin/env python3
# -*- encoding: utf-8 -*-

import subprocess
from pwn import *
#context.log_level = 'debug'

# Byte sequence alias
A8 = 8 * b'A'


class Game:
    def __init__(self, ip, port):
        self.proc = remote(ip, port)
        self.login()
        self.load_game(True)


    def login(self):
        self.proc.recvuntil('hashcash -mb24 ')
        seed = self.proc.recv(8).decode('utf-8')
        hashcash_token = subprocess.run(['hashcash', '-mb24', seed],
                                        capture_output=True).stdout.strip()

        log.info(hashcash_token)
        self.proc.recvuntil('hashcash token: ')
        self.proc.sendline(hashcash_token)


    def load_game(self, should_load):
        self.proc.recvuntil('Load save file?(y/n):')
        self.proc.sendline(b'n')



def main():
    game = Game('203.66.14.26', 31337)
    game.proc.interactive()


if __name__ == '__main__':
    main()
